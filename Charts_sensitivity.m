load('C:\Users\Nick\Desktop\Matlab Sims\Iceland\point');
summary_point=summary; treat_scaleup_point=treat_scaleup; margins_point=margins; R0_scens_point = R0_scens; year_elim_test_point = year_elim_test; inc_year_point = inc_year;
% load('C:\Users\Nick\Desktop\Matlab Sims\Iceland\2yeartest');
% summary_2yeartest=summary; treat_scaleup_2yeartest=treat_scaleup; margins_2yeartest=margins;
% load('C:\Users\Nick\Desktop\Matlab Sims\Iceland\6monthtest');
% summary_6monthtest=summary; treat_scaleup_6monthtest=treat_scaleup; margins_6monthtest=margins;
% load('C:\Users\Nick\Desktop\Matlab Sims\Iceland\2yeartest_noRNA');
summary_2yeartest_noRNA=summary; treat_scaleup_2yeartest_noRNA=treat_scaleup; margins_2yeartest_noRNA=margins; R0_scens_2yeartest_noRNA = R0_scens; year_elim_test_2yeartest = year_elim_test; inc_year_2yeartest = inc_year;
load('C:\Users\Nick\Desktop\Matlab Sims\Iceland\6monthtest_noRNA');
summary_6monthtest_noRNA=summary; treat_scaleup_6monthtest_noRNA=treat_scaleup; margins_6monthtest_noRNA=margins; R0_scens_6monthtest_noRNA = R0_scens;year_elim_test_6monthtest = year_elim_test; inc_year_6monthtest = inc_year;
load('C:\Users\Nick\Desktop\Matlab Sims\Iceland\annualtest_noRNA');
summary_annualtest_noRNA=summary; treat_scaleup_annualtest_noRNA=treat_scaleup; margins_annualtest_noRNA=margins; R0_scens_annualtest_noRNA = R0_scens; year_elim_test_annualtest = year_elim_test; inc_year_annualtest = inc_year;
load('C:\Users\Nick\Desktop\Matlab Sims\Iceland\p_complete99');
summary_pcomp99=summary; treat_scaleup_pcomp99=treat_scaleup; margins_pcomp99=margins; R0_scens_pcomp99 = R0_scens; year_elim_test_pcomp99 = year_elim_test; inc_year_pcomp99 = inc_year;
% load('C:\Users\Nick\Desktop\Matlab Sims\Iceland\r_S4death005');
% summary_r_S4death005=summary; treat_scaleup_r_S4death005=treat_scaleup; margins_r_S4death005=margins;
% load('C:\Users\Nick\Desktop\Matlab Sims\Iceland\rapidRNA');
% summary_rapidRNA=summary; treat_scaleup_rapidRNA=treat_scaleup; margins_rapidRNA=margins;
load('C:\Users\Nick\Desktop\Matlab Sims\Iceland\point_10hr');
summary_0hr=summary; treat_scaleup_0hr=treat_scaleup; margins_0hr=margins; R0_scens_0hr = R0_scens; year_elim_test_0hr = year_elim_test; inc_year_0hr = inc_year;
load('C:\Users\Nick\Desktop\Matlab Sims\Iceland\point_20hr');
summary_20hr=summary; treat_scaleup_20hr=treat_scaleup; margins_20hr=margins; R0_scens_20hr = R0_scens; year_elim_test_20hr = year_elim_test; inc_year_20hr = inc_year;
load('C:\Users\Nick\Desktop\Matlab Sims\Iceland\point_30hr');
summary_30hr=summary; treat_scaleup_30hr=treat_scaleup; margins_30hr=margins; R0_scens_30hr = R0_scens; year_elim_test_30hr = year_elim_test; inc_year_30hr = inc_year;
load('C:\Users\Nick\Desktop\Matlab Sims\Iceland\point_40hr');
summary_40hr=summary; treat_scaleup_40hr=treat_scaleup; margins_40hr=margins; R0_scens_40hr = R0_scens; year_elim_test_40hr = year_elim_test; inc_year_40hr = inc_year;
load('C:\Users\Nick\Desktop\Matlab Sims\Iceland\doubletime');
summary_doubletime=summary; treat_scaleup_doubletime=treat_scaleup; margins_doubletime=margins; R0_scens_doubletime = R0_scens; year_elim_test_doubletime = year_elim_test; inc_year_doubletime = inc_year;
load('C:\Users\Nick\Desktop\Matlab Sims\Iceland\point_99SVR');
summary_99SVR=summary; treat_scaleup_99SVR=treat_scaleup; margins_99SVR=margins; R0_scens_99SVR = R0_scens; year_elim_test_99SVR = year_elim_test; inc_year_99SVR = inc_year;
load('C:\Users\Nick\Desktop\Matlab Sims\Iceland\point_doubletreatnos');
summary_doubletreatnos=summary; treat_scaleup_doubletreatnos=treat_scaleup; margins_doubletreatnos=margins; R0_scens_doubletreatnos = R0_scens; year_elim_test_doubletreatnos = year_elim_test; inc_year_doubletreatnos = inc_year;
load('C:\Users\Nick\Desktop\Matlab Sims\Iceland\point_halfcareer');
summary_hc=summary; treat_scaleup_hc=treat_scaleup; margins_hc=margins; R0_scens_hc = R0_scens; year_elim_test_hc = year_elim_test; inc_year_hc = inc_year;
load('C:\Users\Nick\Desktop\Matlab Sims\Iceland\point_40prev');
summary_40prev=summary;  treat_scaleup_40prev=treat_scaleup; margins_40prev=margins; R0_scens_40prev = R0_scens; year_elim_test_40prev = year_elim_test; inc_year_40prev = inc_year;
load('C:\Users\Nick\Desktop\Matlab Sims\Iceland\point_60prev');
summary_60prev=summary; treat_scaleup_60prev=treat_scaleup; margins_60prev=margins; R0_scens_60prev = R0_scens; year_elim_test_60prev = year_elim_test; inc_year_60prev = inc_year;
% load('C:\Users\Nick\Desktop\Matlab Sims\Iceland\point_5discount');
% summary_5discount=summary; treat_scaleup_5discount=treat_scaleup; margins_5discount=margins;
load('C:\Users\Nick\Desktop\Matlab Sims\Iceland\point_60kPWID');
summary_60kPWID=summary; treat_scaleup_60kPWID=treat_scaleup; margins_60kPWID=margins; R0_scens_60kPWID = R0_scens; year_elim_test_60kPWID = year_elim_test; inc_year_60kPWID = inc_year;
load('C:\Users\Nick\Desktop\Matlab Sims\Iceland\point_100kPWID');
summary_100kPWID=summary; treat_scaleup_100kPWID=treat_scaleup; margins_100kPWID=margins; R0_scens_100kPWID = R0_scens; year_elim_test_100kPWID = year_elim_test; inc_year_100kPWID = inc_year;
% load('C:\Users\Nick\Desktop\Matlab Sims\Iceland\point_8wkDAA');
% summary_8wkDAA=summary; treat_scaleup_8wkDAA=treat_scaleup; margins_8wkDAA=margins;
% load('C:\Users\Nick\Desktop\Matlab Sims\Iceland\point_24wkDAA');
% summary_24wkDAA=summary; treat_scaleup_24wkDAA=treat_scaleup; margins_24wkDAA=margins;
load('C:\Users\Nick\Desktop\Matlab Sims\Iceland\point_90diag');
summary_90diag=summary; treat_scaleup_90diag=treat_scaleup; margins_90diag=margins; R0_scens_90diag = R0_scens; year_elim_test_90diag = year_elim_test; inc_year_90diag = inc_year;

comp = 2; % comparison variable

Table2=round([margins_point(1,[3,5,8,9],1)./[1,1,1,1], inc_year_point(1,11), year_elim_test_point(1), treat_scaleup_point(2:end)', 100*R0_scens_point(2);...
    margins_point(2,[3,5,8,9],1)./[1,1,1,1], inc_year_point(2,11), year_elim_test_point(1), treat_scaleup_point(2:end)', 100*R0_scens_point(2);...
    margins_90diag(comp,[3,5,8,9],1)./[1,1,1,1], inc_year_90diag(comp,11), year_elim_test_90diag(1), treat_scaleup_90diag(2:end)', 100*R0_scens_90diag(2);...
    margins_6monthtest_noRNA(2,[3,5,8,9],1)./[1,1,1,1], inc_year_6monthtest(comp,11), year_elim_test_6monthtest(1), treat_scaleup_6monthtest_noRNA(2:end)', 100*R0_scens_6monthtest_noRNA(2);...
    margins_annualtest_noRNA(2,[3,5,8,9],1)./[1,1,1,1], inc_year_annualtest(comp,11), year_elim_test_annualtest(1), treat_scaleup_annualtest_noRNA(2:end)', 100*R0_scens_annualtest_noRNA(2);...
    margins_2yeartest_noRNA(2,[3,5,8,9],1)./[1,1,1,1], inc_year_2yeartest(comp,11), year_elim_test_2yeartest(1), treat_scaleup_2yeartest_noRNA(2:end)', 100*R0_scens_2yeartest_noRNA(2);...
%     margins_point(5,[3,5,8,9],1)./[1,1,1,1], year_elim_test(1), treat_scaleup_point(2:end)', 100*R0_scens(2);...
%     margins_point(6,[3,5,8,9],1)./[1,1,1,1], year_elim_test(1), treat_scaleup_point(2:end)', 100*R0_scens(2);...
%     margins_point(3,[3,5,8,9],1)./[1,1,1,1], year_elim_test(1), treat_scaleup_point(2:end)', 100*R0_scens(2);...
%     margins_point(4,[3,5,8,9],1)./[1,1,1,1], year_elim_test(1), treat_scaleup_point(2:end)', 100*R0_scens(2);...
    margins_40prev(comp,[3,5,8,9],1)./[1,1,1,1], inc_year_40prev(comp,11), year_elim_test_40prev(1), treat_scaleup_40prev(2:end)', 100*R0_scens_40prev(2);...
    margins_60prev(comp,[3,5,8,9],1)./[1,1,1,1], inc_year_60prev(comp,11), year_elim_test_60prev(1), treat_scaleup_60prev(2:end)', 100*R0_scens_60prev(2);...
    margins_60kPWID(comp,[3,5,8,9],1)./[1,1,1,1], inc_year_60kPWID(comp,11), year_elim_test_60kPWID(1), treat_scaleup_60kPWID(2:end)', 100*R0_scens_60kPWID(2);...
    margins_100kPWID(comp,[3,5,8,9],1)./[1,1,1,1], inc_year_100kPWID(comp,11), year_elim_test_100kPWID(1), treat_scaleup_100kPWID(2:end)', 100*R0_scens_100kPWID(2);...
    margins_hc(comp,[3,5,8,9],1)./[1,1,1,1], inc_year_hc(comp,11), year_elim_test_hc(1), treat_scaleup_hc(2:end)', 100*R0_scens_hc(2);...
    margins_0hr(comp,[3,5,8,9],1)./[1,1,1,1], inc_year_0hr(comp,11), year_elim_test_0hr(1), treat_scaleup_0hr(2:end)', 100*R0_scens_0hr(2);...
    margins_20hr(comp,[3,5,8,9],1)./[1,1,1,1], inc_year_20hr(comp,11), year_elim_test_20hr(1), treat_scaleup_20hr(2:end)', 100*R0_scens_20hr(2);...
    margins_30hr(comp,[3,5,8,9],1)./[1,1,1,1], inc_year_30hr(comp,11), year_elim_test_30hr(1), treat_scaleup_30hr(2:end)', 100*R0_scens_30hr(2);...
    margins_40hr(comp,[3,5,8,9],1)./[1,1,1,1], inc_year_40hr(comp,11), year_elim_test_40hr(1), treat_scaleup_40hr(2:end)', 100*R0_scens_40hr(2);...
%     margins_6monthtest(4,[3,5,8,9],1)./[1,1,1,1], year_elim_test(1), treat_scaleup_6monthtest(2:end)', 100*R0_scens(2);...
%     margins_2yeartest(4,[3,5,8,9],1)./[1,1,1,1], year_elim_test(1), treat_scaleup_2yeartest(2:end)', 100*R0_scens(2);...
    margins_pcomp99(comp,[3,5,8,9],1)./[1,1,1,1], inc_year_pcomp99(comp,11), year_elim_test_pcomp99(1), treat_scaleup_pcomp99(2:end)', 100*R0_scens_pcomp99(2);...
    margins_doubletime(comp,[3,5,8,9],1)./[1,1,1,1], inc_year_doubletime(comp,11), year_elim_test_doubletime(1), treat_scaleup_doubletime(2:end)', 100*R0_scens_doubletime(2);...
    margins_doubletreatnos(comp,[3,5,8,9],1)./[1,1,1,1], inc_year_doubletreatnos(comp,11), year_elim_test_doubletreatnos(1), treat_scaleup_doubletreatnos(2:end)', 100*R0_scens_doubletreatnos(2);...
%     margins_8wkDAA(comp,[3,5,8,9],1)./[1,1,1,1], year_elim_test(1), treat_scaleup_8wkDAA(2:end)', 100*R0_scens(2);...
%     margins_24wkDAA(comp,[3,5,8,9],1)./[1,1,1,1], year_elim_test(1), treat_scaleup_24wkDAA(2:end)', 100*R0_scens(2);...
    margins_99SVR(comp,[3,5,8,9],1)./[1,1,1,1], inc_year_99SVR(comp,11), year_elim_test_99SVR(1), treat_scaleup_99SVR(2:end)', 100*R0_scens_99SVR(2)]);
Table2(:,end) = Table2(:,end)/100;


%Percentage difference in outcomes
Table3 = -round(100 * (repmat(Table2(2,:),length(Table2(:,1)),1) - Table2) ./ Table2);
%Table3(:,4) = round(100*(repmat(Table2(2,1),length(Table2(:,1)),1) - Table2(:,1)) ./ (repmat(Table2(2,2),length(Table2(:,2)),1) - Table2(:,2)));


Table4 = zeros(length(Table3(:,1)),1+length(Table3(1,:)));
Table4 = num2cell(Table4);
Table4{1,1} = 'Base';
Table4{2,1} = 'Projected scale-up';
Table4{3,1} = '90% diagnosed';
Table4{4,1} = '6-monthly Ab testing';
Table4{5,1} = 'Annual Ab testing';
Table4{6,1} = '2-yearly Ab testing';
Table4{7,1} = '30prev';
Table4{8,1} = '50prev';
Table4{9,1} = '200 PWID';
Table4{10,1} = '1000 PWID';
Table4{11,1} = 'half career';
Table4{12,1} = '0HR';
Table4{13,1} = '20HR';
Table4{14,1} = '30HR';
Table4{15,1} = '40HR';
Table4{16,1} = 'pcomp99';
Table4{17,1} = 'doubletime';
Table4{18,1} = 'double treat nos';
Table4{19,1} = '95% SVR';

for i = 1:length(Table3(:,1))
    for j = 1:length(Table3(1,:))
        Table4{i,j+1} = [num2str(Table2(i,j))];%,' (',num2str(Table3(i,j)),'%)'];
%         if j >=7 && j <=9
%             Table4{i,j+1} = [num2str(round(Table2(i,j)/400 * 1000)),' /1000 PWID'];
%         end
    end
end


%% CIs
% Table2_LB=round([margins_point(1,:,2)./[10^6,10^3,10^3,1,1,1,1,1,1], treat_scaleup_point;...
%     margins_point(2,:,2)./[10^6,10^3,10^3,1,1,1,1,1,1], treat_scaleup_point;...
%     margins_point(5,:,2)./[10^6,10^3,10^3,1,1,1,1,1,1], treat_scaleup_point;...
%     margins_point(6,:,2)./[10^6,10^3,10^3,1,1,1,1,1,1], treat_scaleup_point;...
%     margins_point(3,:,2)./[10^6,10^3,10^3,1,1,1,1,1,1], treat_scaleup_point;...
%     margins_point(4,:,2)./[10^6,10^3,10^3,1,1,1,1,1,1], treat_scaleup_point;...
%     margins_40prev(comp,:,2)./[10^6,10^3,10^3,1,1,1,1,1,1], treat_scaleup_40prev;...
%     margins_60prev(comp,:,2)./[10^6,10^3,10^3,1,1,1,1,1,1], treat_scaleup_60prev;...
%     margins_60kPWID(comp,:,2)./[10^6,10^3,10^3,1,1,1,1,1,1], treat_scaleup_60kPWID;...
%     margins_100kPWID(comp,:,2)./[10^6,10^3,10^3,1,1,1,1,1,1], treat_scaleup_100kPWID;...
%     margins_hc(comp,:,2)./[10^6,10^3,10^3,1,1,1,1,1,1], treat_scaleup_hc;...
%     margins_0hr(comp,:,2)./[10^6,10^3,10^3,1,1,1,1,1,1], treat_scaleup_0hr;...
%     margins_20hr(comp,:,2)./[10^6,10^3,10^3,1,1,1,1,1,1], treat_scaleup_20hr;...
%     margins_30hr(comp,:,2)./[10^6,10^3,10^3,1,1,1,1,1,1], treat_scaleup_30hr;...
%     margins_40hr(comp,:,2)./[10^6,10^3,10^3,1,1,1,1,1,1], treat_scaleup_40hr;...
%     margins_6monthtest_noRNA(5,:,2)./[10^6,10^3,10^3,1,1,1,1,1,1], treat_scaleup_6monthtest_noRNA;...
%     margins_2yeartest_noRNA(5,:,2)./[10^6,10^3,10^3,1,1,1,1,1,1], treat_scaleup_2yeartest_noRNA;...
%     margins_6monthtest(4,:,2)./[10^6,10^3,10^3,1,1,1,1,1,1], treat_scaleup_6monthtest;...
%     margins_2yeartest(4,:,2)./[10^6,10^3,10^3,1,1,1,1,1,1], treat_scaleup_2yeartest;...
%     margins_pcomp99(comp,:,2)./[10^6,10^3,10^3,1,1,1,1,1,1], treat_scaleup_pcomp99;...
%     margins_doubletime(comp,:,2)./[10^6,10^3,10^3,1,1,1,1,1,1], treat_scaleup_doubletime;...
%     margins_doubletreatnos(comp,:,2)./[10^6,10^3,10^3,1,1,1,1,1,1], treat_scaleup_doubletreatnos;...
%     margins_8wkDAA(comp,:,2)./[10^6,10^3,10^3,1,1,1,1,1,1], treat_scaleup_8wkDAA;...
%     margins_24wkDAA(comp,:,2)./[10^6,10^3,10^3,1,1,1,1,1,1], treat_scaleup_24wkDAA;...
%     margins_99SVR(comp,:,2)./[10^6,10^3,10^3,1,1,1,1,1,1], treat_scaleup_99SVR]);
% 
% 
% Table2_UB=round([margins_point(1,:,3)./[10^6,10^3,10^3,1,1,1,1,1,1], treat_scaleup_point;...
%     margins_point(2,:,3)./[10^6,10^3,10^3,1,1,1,1,1,1], treat_scaleup_point;...
%     margins_point(5,:,3)./[10^6,10^3,10^3,1,1,1,1,1,1], treat_scaleup_point;...
%     margins_point(6,:,3)./[10^6,10^3,10^3,1,1,1,1,1,1], treat_scaleup_point;...
%     margins_point(3,:,3)./[10^6,10^3,10^3,1,1,1,1,1,1], treat_scaleup_point;...
%     margins_point(4,:,3)./[10^6,10^3,10^3,1,1,1,1,1,1], treat_scaleup_point;...
%     margins_40prev(comp,:,3)./[10^6,10^3,10^3,1,1,1,1,1,1], treat_scaleup_40prev;...
%     margins_60prev(comp,:,3)./[10^6,10^3,10^3,1,1,1,1,1,1], treat_scaleup_60prev;...
%     margins_60kPWID(comp,:,3)./[10^6,10^3,10^3,1,1,1,1,1,1], treat_scaleup_60kPWID;...
%     margins_100kPWID(comp,:,3)./[10^6,10^3,10^3,1,1,1,1,1,1], treat_scaleup_100kPWID;...
%     margins_hc(comp,:,3)./[10^6,10^3,10^3,1,1,1,1,1,1], treat_scaleup_hc;...
%     margins_0hr(comp,:,3)./[10^6,10^3,10^3,1,1,1,1,1,1], treat_scaleup_0hr;...
%     margins_20hr(comp,:,3)./[10^6,10^3,10^3,1,1,1,1,1,1], treat_scaleup_20hr;...
%     margins_30hr(comp,:,3)./[10^6,10^3,10^3,1,1,1,1,1,1], treat_scaleup_30hr;...
%     margins_40hr(comp,:,3)./[10^6,10^3,10^3,1,1,1,1,1,1], treat_scaleup_40hr;...
%     margins_6monthtest_noRNA(5,:,3)./[10^6,10^3,10^3,1,1,1,1,1,1], treat_scaleup_6monthtest_noRNA;...
%     margins_2yeartest_noRNA(5,:,3)./[10^6,10^3,10^3,1,1,1,1,1,1], treat_scaleup_2yeartest_noRNA;...
%     margins_6monthtest(4,:,3)./[10^6,10^3,10^3,1,1,1,1,1,1], treat_scaleup_6monthtest;...
%     margins_2yeartest(4,:,3)./[10^6,10^3,10^3,1,1,1,1,1,1], treat_scaleup_2yeartest;...
%     margins_pcomp99(comp,:,3)./[10^6,10^3,10^3,1,1,1,1,1,1], treat_scaleup_pcomp99;...
%     margins_doubletime(comp,:,3)./[10^6,10^3,10^3,1,1,1,1,1,1], treat_scaleup_doubletime;...
%     margins_doubletreatnos(comp,:,3)./[10^6,10^3,10^3,1,1,1,1,1,1], treat_scaleup_doubletreatnos;...
%     margins_8wkDAA(comp,:,3)./[10^6,10^3,10^3,1,1,1,1,1,1], treat_scaleup_8wkDAA;...
%     margins_24wkDAA(comp,:,3)./[10^6,10^3,10^3,1,1,1,1,1,1], treat_scaleup_24wkDAA;...
%     margins_99SVR(comp,:,3)./[10^6,10^3,10^3,1,1,1,1,1,1], treat_scaleup_99SVR]);

